file---
title: "Temperature Graph Draft"
author: "Susannah Budd"
date: "2/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Concord, NH Temperature Graph
Plot of maximum temperatures in Concord, New Hampshire from 1939-2019 with best fit line:

```{r, echo=FALSE}
##Read CSV Data
climate_data<-read.csv("/home/CAMPUS/scba2018/Climate_Change_Narratives/student_folders/Budd/susannah_concordnh_data.csv")
```

```{r, echo=FALSE}
##Fix Dates
strDates<-as.character(climate_data$DATE)
climate_data$NewDate<-as.Date(strDates, "%m/%d/%Y")
```

```{r, echo=FALSE}
##Define Portions of "NewDate"
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(as.Date(climate_data$NewDate), format = "%Y")
MonthlyTMAXMean = aggregate(TMAX~Month+Year, climate_data, mean)
MonthlyTMAXMean$Year=as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$YEAR=as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH=as.numeric(MonthlyTMAXMean$Month)
```

```{r, echo=FALSE}
##New Plots
plot(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="09",], ty='l', xlim=c(1939, 2019), main = "TMAX for September (degrees Celsius) vs Time (years)", xlab = "Time (years)", ylab = "TMAX for September (degrees Celsius)", col.main = "red", col.lab = "red")
September.lm <- lm(TMAX~YEAR, data=MonthlyTMAXMean[MonthlyTMAXMean$Month=="09",])
abline(coef(September.lm), col="red")
```

```{r, echo=FALSE}
##Monthly Minimums
MonthlyTMINMean = aggregate(TMIN~Month+Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
```

```{r, include=FALSE}
##Fixing the Format of Month and Year as numeric
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)
head(MonthlyTMINMean)
```

```{r, echo=FALSE}
##Read Leaf Observation CSV Data
leaf_observations <- read.csv("/home/CAMPUS/scba2018/Climate_Change_Narratives/student_folders/Budd/Leaf-Chart-1-1.csv")
```

```{r, echo=FALSE}
##Plot Leaf Observation Data
plot(Range~Year, leaf_observations, ty='l', main = "Length of Foliage Season (days) vs. Year", xlab = "Foliage Season Length (days)", ylab = "Year", col.main = "red", col.lab = "red")
##Add Best Fit Line
c<-coef(lm(Range~Year, leaf_observations))
abline(c, col="red")
```

