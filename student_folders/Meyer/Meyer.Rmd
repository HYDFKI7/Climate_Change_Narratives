---
title: "Draft Climate"
author: "Ella"
date: "2/5/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Upload Data Into R

Into some directory???

climatechangenarratives/studentfolders/lastname...

```{r, echo=FALSE, results='hide'}
filepath = "/home/CAMPUS/ekma2018/Climate_Change_Narratives/student_folders/Meyer/ella_seattle_data.csv"
climate_data = read.csv(filepath)
head(climate_data)
str(climate_data)
```

## Fixing Dates

```{r}
strDates = as.character(climate_data$DATE)
climate_data$NewDate = as.Date(strDates, "%m/%d/%Y")

```
```{r,}
CYear = sub("/([0-9]+)$", "/19\\1", strDates[1:18993]) # Defined for this dataset! 
CYear = c(CYear, sub("/([0-9]+)$", "/20\\1", strDates[18994:25959]))
head(CYear)

climate_data$NewDate <- as.Date(CYear, "%m/%d/%Y")

str(climate_data)
```

## Plot Data

```{r}
plot(TMAX ~ NewDate, climate_data)
```


## Add Best Fit Line

```{r}
lm(TMAX ~ NewDate, climate_data)

plot(lm(TMAX ~ NewDate, climate_data))
```


## Monthly Means

```{r}
climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")

```

## Plots

```{r, echo=FALSE}

climate_data$Month = format(as.Date(climate_data$NewDate), format = "%m")
climate_data$Year = format(climate_data$NewDate, format="%Y")


Months = c("January", "February", "March", "April",
           "May", "June", "July", "August", "September", "October",
           "November", "December")



## Monthly Max

MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)

MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)



plot(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH == 8, ], ty = "l", las = 1, xlim = c(1945, 2020),
       main = Months[8])


par(mfrow = c(4, 3), mar = c(5, 4, 3, 2) + 0.1)
TMAXresult <- NA
for (i in 1:12) {
  plot(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH ==
                                             i, ], ty = "l", las = 1, xlim = c(1945, 2020),
       main = Months[i])
  Month.lm <- lm(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH ==
                                                       i, ])
  print(summary(Month.lm))
  abline(coef(Month.lm), col = "red")
  TMAXresult <- rbind(TMAXresult, cbind(Months[i],
                                        round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,
                                                                                                          4], 4), round(summary(Month.lm)$r.squared,
                                                                                                                        3)))
}
```


## Seattle Climate Links

https://www.citylab.com/environment/2018/04/seattle-thinks-it-knows-rain-climate-change-begs-to-differ/557291/
https://www.usatoday.com/story/news/nation/2019/02/10/seattle-snowiest-february-70-years-more-coming/2830164002/
