---
title: "1st Plot Attempt"
author: "Siddharth Namachivayam"
date: "2/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Plot of Albuquerque Data

Here is my plot of Albuquerque maximum temperatures overlayed with a best fit line:

```{r maxabq_plot, echo=FALSE}
climate_data=read.csv("/home/CAMPUS/snab2018/Climate_Change_Narratives/student_folders/Namachivayam/siddharth_abq_data.csv")
strDates=as.character(climate_data$DATE)
climate_data$DATES=as.Date(strDates,"%Y-%m-%d")
plot(TMAX~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(TMAX~DATES,climate_data),col="red")
title(main="TMAX vs YEAR")
```

Lets look at some of the results for this regression:

```{r maxresults, echo=FALSE}
summary(lm(TMAX~DATES,climate_data))
```

Note that the p-value for the y-intercept is 2x10^-6 and the p-value for the slope of the line is .02. Both of these values are less than .05. In other words, we can say with 95% confidence that our temperature is increasing at a rate  of 1.356x10^-5 degrees C per year and has an intercept of 21.28 degrees C.  

Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r maxmonthly, echo=FALSE}
climate_data$Month = format(as.Date(climate_data$DATES), format = "%m")
climate_data$Year = format(climate_data$DATES, format="%Y")
MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)
MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
TMAXresult=NA
for (i in 1:12) {
plot(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
TMAXresult=rbind(TMAXresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Ok cool. Let's do the same thing except for TMIN data now instead.

```{r minabq_plot, echo=FALSE}
plot(TMIN~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(TMIN~DATES,climate_data),col="red")
title(main="TMIN vs YEAR")
```

Lets look at some of the results for this regression:

```{r minresults, echo=FALSE}
summary(lm(TMIN~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r minmonthly, echo=FALSE}
MonthlyTMINMean = aggregate(TMIN ~ Month + Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
TMINresult=NA
for (i in 1:12) {
plot(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
TMINresult=rbind(TMINresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Ok lets take a break from all this temprature stuff and look at precipitation instead.

```{r precabq_plot, echo=FALSE}
plot(PRCP~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(PRCP~DATES,climate_data),col="red")
title(main="PRCP vs YEAR")
summary(lm(PRCP~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r precmonthly, echo=FALSE}
MonthlyPRCPMean = aggregate(PRCP ~ Month + Year, climate_data, mean)
MonthlyPRCPMean$YEAR = as.numeric(MonthlyPRCPMean$Year)
MonthlyPRCPMean$MONTH = as.numeric(MonthlyPRCPMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
PRCPresult=NA
for (i in 1:12) {
plot(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
PRCPresult=rbind(PRCPresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Sources to look at:
https://onlinelibrary.wiley.com/doi/full/10.1002/eco.1849
http://adsabs.harvard.edu/abs/2016AGUFMGC32C..04S
https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.12743
https://www.sciencedirect.com/science/article/pii/S0190052816300323
https://bioone.org/journals/Rangelands/volume-30/issue-3/1551-501X(2008)30[23:CCAEOT]2.0.CO;2/Climate-Change-and-Ecosystems-of-the-Southwestern-United-States/10.2111/1551-501X(2008)30[23:CCAEOT]2.0.CO;2.full
https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2008GL035075