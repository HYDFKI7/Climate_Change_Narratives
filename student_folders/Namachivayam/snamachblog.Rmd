---
title: "Rising Temperatures and Drought in Albuquerque, New Mexico"
author: "Siddharth Namachivayam"
date: "2/22/2019"
output: html_document
---
<style>
body {
    background-color: #FFEDBA;
}

div.a {
  text-align: center;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<div class="a">
## Background
```{r picture, echo=FALSE, out.width = '40%'}
knitr::include_graphics("NM.png")
```
</div>

<br>
Above is a map of varying drought conditions across the state of New Mexico in late June during an intense southwest drought which began in 2018. For the vast majority of that year, over 50% of the state was categorized as consistently experiencing 'severe drought' by the USDA drought monitor. Unsurprisingly, this drought has had considerable impacts on the state of New Mexico with long-term consequences continuing into 2019. For example, exceedingly dry conditions increased the risk of wildfire and exacerbated water scarcity issues across the state. Farmers became more dependent on pumping groundwater due to reduced water allotments, escalating the cost of crop production. Specifically, in the city of Albuquerque, the drought caused numerous issues with regards to urban water supply, leading to uncertainty around the reliability of reservoirs. 

Clearly, extreme events like the recent drought in the southwest have pressing and important implications for the city of Albuquerque and the state of New Mexico. Understanding how such events occur and what factors amplify/facilitate them will be of crucial importance in planning and preparing against the negative impacts of severe drought. Thus, while creating this blog, I was interested in the following question: given the above severity of New Mexico's ongoing drought, what climatic trends in temperature facilitated and amplified the observed extreme weather behavior?

In order to reduce the scope of my analysis, I decided to strictly look at temperature data from the city of Albuquerque. The analysis of this data is presented below.

<div class="a">
## Analyzing Albuquerque Data

```{r maxabq_plot, echo=FALSE}
climate_data=read.csv("/Users/siddharth/R_Projects/Climate_Change_Narratives/student_folders/Namachivayam/siddharth_abq_data.csv")
strDates=as.character(climate_data$DATE)
climate_data$DATES=as.Date(strDates,"%Y-%m-%d")
plot(TMAX~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(TMAX~DATES,climate_data),col="red")
title(main="TMAX vs YEAR")
```
</div>

Above is a plot of Albuquerque maximum temperatures  overlayed with a best fit line.

Lets look at some of the results for this regression:

```{r maxresults, echo=FALSE}
summary(lm(TMAX~DATES,climate_data))
```

Note that the p-value for the y-intercept is 2x10^-6 and the p-value for the slope of the line is .02. Both of these values are less than .05. In other words, we can say with 95% confidence that our temperature is increasing at a rate  of 1.356x10^-5 degrees C per year and has an intercept of 21.28 degrees C.  

Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r maxmonthly, echo=FALSE}
climate_data$Month = format(as.Date(climate_data$DATES), format = "%m")
climate_data$Year = format(climate_data$DATES, format="%Y")
MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)
MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
TMAXresult=NA
for (i in 1:12) {
plot(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
TMAXresult=rbind(TMAXresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Ok cool. Let's do the same thing except for TMIN data now instead.

```{r minabq_plot, echo=FALSE}
plot(TMIN~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(TMIN~DATES,climate_data),col="red")
title(main="TMIN vs YEAR")
```

Lets look at some of the results for this regression:

```{r minresults, echo=FALSE}
summary(lm(TMIN~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r minmonthly, echo=FALSE}
MonthlyTMINMean = aggregate(TMIN ~ Month + Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
TMINresult=NA
for (i in 1:12) {
plot(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
TMINresult=rbind(TMINresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Ok lets take a break from all this temprature stuff and look at precipitation instead.

```{r precabq_plot, echo=FALSE}
plot(PRCP~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(PRCP~DATES,climate_data),col="red")
title(main="PRCP vs YEAR")
summary(lm(PRCP~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r precmonthly, echo=FALSE}
MonthlyPRCPMean = aggregate(PRCP ~ Month + Year, climate_data, mean)
MonthlyPRCPMean$YEAR = as.numeric(MonthlyPRCPMean$Year)
MonthlyPRCPMean$MONTH = as.numeric(MonthlyPRCPMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
PRCPresult=NA
for (i in 1:12) {
plot(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
PRCPresult=rbind(PRCPresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Sources to look at:
https://onlinelibrary.wiley.com/doi/full/10.1002/eco.1849
http://adsabs.harvard.edu/abs/2016AGUFMGC32C..04S
https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.12743
https://www.sciencedirect.com/science/article/pii/S0190052816300323
https://bioone.org/journals/Rangelands/volume-30/issue-3/1551-501X(2008)30[23:CCAEOT]2.0.CO;2/Climate-Change-and-Ecosystems-of-the-Southwestern-United-States/10.2111/1551-501X(2008)30[23:CCAEOT]2.0.CO;2.full
https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2008GL035075
