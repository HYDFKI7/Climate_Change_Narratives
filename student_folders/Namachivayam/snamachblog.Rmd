---
title: "Rising Temperatures and Drought in Albuquerque, New Mexico"
author: "Siddharth Namachivayam"
date: "2/25/2019"
output: html_document
---
<style>
body {
    background-color: #FFEDBA;
}

div.a {
  text-align: center;
}

.caption {
    font-size: x-small;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<div class="a">
## Background
```{r picture1, echo=FALSE, out.width = '41%'}
knitr::include_graphics("NM.png")
```
</div>

<br>
The above map displays varying drought conditions across the state of New Mexico in late June during the intense Southwest drought which began in 2018. For the vast majority of that year, the USDA drought monitor categorized around 70% of the state as consistently experiencing at least 'severe drought.' Unsurprisingly, this drought has had considerable impacts on the state of New Mexico with long-term consequences continuing into 2019. For example, exceedingly dry conditions increased the number of wildfires and also exacerbated water scarcity issues across the state. Specifically in the city of Albuquerque, the drought caused numerous issues with regards to urban water supply, leading to uncertainty around the reliability of reservoirs. 

Clearly, extreme events like the recent drought in the southwest have pressing and important implications for the city of Albuquerque and the state of New Mexico. Understanding how such events occur and what factors amplify/facilitate them will be of crucial importance in planning and preparing against the negative impacts of severe drought. Thus, while creating this blog, I was interested in the following question: given the above severity of New Mexico's ongoing drought, what climatic trends in temperature facilitated and amplified the observed extreme weather behavior?

In order to reduce the scope of my analysis, I decided to strictly look at temperature trends within the city of Albuquerque. The station at Albuquerque International Airport provided all the raw data analyzed and presented in the section below.

<div class="a">
## Analyzing Albuquerque Data
</div>
In order to analyze temperature trends, I initially created 12 sets of data (January, February, March, etc.), each looking at the monthly averages of Albuquerque minimum temperatures. I then plotted the data from 1931 to 2019 and then added a best fit line for each plot:

<div class="a">
```{r minabq_plot, echo=FALSE}
climate_data=read.csv("siddharth_abq_data.csv")
strDates=as.character(climate_data$DATE)
climate_data$DATES=as.Date(strDates,"%Y-%m-%d")

climate_data$Month = format(as.Date(climate_data$DATES), format = "%m")
climate_data$Year = format(climate_data$DATES, format="%Y")

MonthlyTMINMean = aggregate(TMIN ~ Month + Year, climate_data, mean)
MonthlyTMINMean$YEAR = as.numeric(MonthlyTMINMean$Year)
MonthlyTMINMean$MONTH = as.numeric(MonthlyTMINMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(3, 4), mar = c(5, 4, 3, 2) + 0.1)
TMINresult=NA
for (i in 1:12) {
plot(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,], ty = "p", pch=20, las = 1, main = Months[i], ylab="TMIN (°C)")
Month.lm=lm(TMIN ~ YEAR, data = MonthlyTMINMean[MonthlyTMINMean$MONTH==i,])
abline(coef(Month.lm), col = "red",lwd=3)
TMINresult=rbind(TMINresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```
</div> 
<br>
Note each best fit line has a clear positive (or increasing) slope. To determine whether these positive trends are statistically significant (i.e. fit the data well), statisticians look at a measure known as the 'p-value.' Essentially, p-values indicate the probability of a certain observed result occuring. So, the lower the p-value, the higher the significance of a result. There are a lot of calculations that go into finding this p-value, but if it is less than 0.05, then statisticians consider the corresponding result to be statistically significant. 

In the above 12 graphs for Albuquerque minimum temperatures, each best fit line had p-values less than 0.05. This means our positive trend lines fit the data really well! Hence, we have strong evidence that the monthly averages for Albuquerque minimum temperatures have been steadily increasing since 1931 for all 12 months. 

<div class="a">
## How Can We Trust The Data?
</div> 

Many climate skeptics forward the argument that measurements from places like Albuquerque International Airport are unreliable due to a phenomenon called the 'urban heat island effect.' To an extent, the skeptics aren't wrong in that urban areas tend to produce more heat than surrounding rural or unpopulated regions. However, scientists account for this disparity by removing the effect through a process known as 'homogenization.' Simply put, homogenization compares data from urban stations to surrounding stations in order to make appropriate adjustments for proper climate measurement. 

<div class="a">
```{r picture2, echo=FALSE, fig.cap="Illustration of Urban Heat Island Effect", out.width = '48%'}
knitr::include_graphics("UHI.jpg")
```
</div> 

Unfortunately, some climate skeptics have accused even these adjustments of containing an additional 'warm' bias. However, thorough studies on the reliability of the U.S. surface temperature recor, indicate that such adjustments are both appropriate and necessary. Furthermore, they suggest any potential 'warm' biases towards daily minimum temperatures are essentially negligible. In light of these studies along with the increasing trends observed in our above data analysis, there should be no doubt that Albuquerque is indeed warming.

<div class="a">
## What Do Rising Temperatures Have To Do With Drought?

**There are two main reasons that rising temperatures in Albuquerque could potentially amplify/facilitate severe drought:**
</div> 

**1) Mountain snowpack-** Flow in the Rio Grande river is one of the best indicators of drought for New Mexico. This is because runoff into the Rio Grande directly relates to snowpack in the Jemez mountains, a crucial source for New Mexico's water supply. The Jemez mountains will have similar climatic trends to Albuquerque International Airport, even if the trends are shifted downward due to altitude. In other words, we expect the Jemez mountains to exhibit warming. Higher winter temperatures in the mountains precipitate more rain than snow, decreasing snowpack. In addition, higher spring temperatures melt snowpack earlier, ultimately extending the duration and intensity of summer drought.  

<div class="a">
```{r picture3, echo=FALSE, fig.cap="Snowpack in Northern New Mexico", out.width = '41%'}
knitr::include_graphics("Snowpack.png")
```
</div> 

**2) Evapotranspiration-** Evapotranspiration is the combined effect of evaporation and transpiration. Since higher temperatures cause more liquid water to convert to gas and encourage plants to open up their stomata, we should expect an increase in evapotranspiration. We should note, however, that transpiration in New Mexico is slightly mitigated by the presence of drought-resilient CAM plants in the desert. Overall though, rising temperatures tend to decrease the amount of available water by evapotranspirating it into the atmosphere, further contributing to extreme drought conditions.
<div class="a">
```{r picture4, echo=FALSE, fig.cap="Illustration of Evapotranspiration", out.width = '25.5%'}
knitr::include_graphics("evapo.png")
```

## Impacts of Drought
</div> 

<div class="a">
## Conclusion
</div>

<div class="a">
## Citations
</div>

## EVERYTHING BELOW IS EXTRANEOUS
Interestingly, when looking at monthly averages of Albuquerque maximum temperatures, only the month of March had p-values less than 0.05 (hence it was the only month statistically significant):
```{r maxabq_plot, echo=FALSE}
MonthlyTMAXMean = aggregate(TMAX ~ Month + Year, climate_data, mean)
MonthlyTMAXMean$YEAR = as.numeric(MonthlyTMAXMean$Year)
MonthlyTMAXMean$MONTH = as.numeric(MonthlyTMAXMean$Month)

Months = c("","","March")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
TMAXresult=NA
for (i in 3:3) {
plot(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,], ty = "l", las = 1, main = Months[i], ylab="TMAX (°C)")
Month.lm=lm(TMAX ~ YEAR, data = MonthlyTMAXMean[MonthlyTMAXMean$MONTH==i,])
abline(coef(Month.lm), col = "red")
TMAXresult=rbind(TMAXresult, cbind(Months[i], round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Above is a plot of Albuquerque maximum temperatures overlayed with a best fit line.

Lets look at some of the results for this regression:

```{r maxresults, echo=FALSE}
summary(lm(TMAX~DATES,climate_data))
```

Note the p-value for the y-intercept is 2x10^-6 and the p-value for the slope of the line is .02. Both of these values are less than .05. In other words, we can say with 95% confidence that our temperature is increasing at a rate  of 1.356x10^-5 degrees C per year and has an intercept of 21.28 degrees C.  

Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

Ok cool. Let's do the same thing except for TMIN data now instead.


Lets look at some of the results for this regression:

```{r minresults, echo=FALSE}
summary(lm(TMIN~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 


Ok lets take a break from all this temprature stuff and look at precipitation instead.

```{r precabq_plot, echo=FALSE}
plot(PRCP~DATES, climate_data,ty='l',xlab="YEAR")
abline(lm(PRCP~DATES,climate_data),col="red")
title(main="PRCP vs YEAR")
summary(lm(PRCP~DATES,climate_data))
```

[SOME ANALYSIS]
Let's go ahead and clean up our original graph by looking at monthly averages one month at a time. 

```{r precmonthly, echo=FALSE}
MonthlyPRCPMean = aggregate(PRCP ~ Month + Year, climate_data, mean)
MonthlyPRCPMean$YEAR = as.numeric(MonthlyPRCPMean$Year)
MonthlyPRCPMean$MONTH = as.numeric(MonthlyPRCPMean$Month)

Months = c("January", "February", "March", "April",
"May", "June", "July", "August", "September", "October",
"November", "December")

par(mfrow = c(1, 1), mar = c(5, 4, 3, 2) + 0.1)
PRCPresult=NA
for (i in 1:12) {
plot(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,], ty = "l", las = 1, main = Months[i])
Month.lm=lm(PRCP ~ YEAR, data = MonthlyPRCPMean[MonthlyPRCPMean$MONTH==i,])
print(summary(Month.lm))
abline(coef(Month.lm), col = "red")
PRCPresult=rbind(PRCPresult, cbind(Months[i],
round(coef(Month.lm)[2], 4), round(summary(Month.lm)$coefficients[2,4], 4), round(summary(Month.lm)$r.squared,3)))
}
```

Sources to look at:
https://onlinelibrary.wiley.com/doi/full/10.1002/eco.1849
http://adsabs.harvard.edu/abs/2016AGUFMGC32C..04S
https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.12743
https://www.sciencedirect.com/science/article/pii/S0190052816300323
https://bioone.org/journals/Rangelands/volume-30/issue-3/1551-501X(2008)30[23:CCAEOT]2.0.CO;2/Climate-Change-and-Ecosystems-of-the-Southwestern-United-States/10.2111/1551-501X(2008)30[23:CCAEOT]2.0.CO;2.full
https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2008GL035075
